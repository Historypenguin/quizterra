<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quizterra | Study Mode</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
    body {
        margin: 0;
        padding: 0;
        font-family: Poppins, sans-serif;
        background: #f2f2f2;
    }

    .container {
        width: 90%;
        max-width: 900px;
        margin: auto;
        padding-top: 30px;
    }

    .question-box {
        background: white;
        padding: 20px;
        border-radius: 12px;
        font-size: 22px;
        font-weight: 600;
        box-shadow: 0 3px 10px rgba(0,0,0,0.15);
    }

    .options {
        margin-top: 20px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
    }

    .option {
        padding: 18px;
        border-radius: 12px;
        font-size: 18px;
        background: #fff;
        border: 3px solid #ccc;
        cursor: pointer;
        user-select: none;
        transition: 0.2s;
        text-align: center;
    }

    .option:hover {
        transform: scale(1.02);
    }

    .option-correct {
        border-color: #3cb043 !important;
        background: #d9f8df !important;
    }

    .option-wrong {
        border-color: #d00000 !important;
        background: #ffd8d8 !important;
    }

    #nextBtn {
        margin-top: 25px;
        padding: 15px 25px;
        font-size: 18px;
        background: #333;
        color: white;
        border: none;
        border-radius: 12px;
        cursor: pointer;
    }

    #nextBtn:disabled {
        background: #777;
        cursor: not-allowed;
    }

    /* Fullscreen image modal */
    #imageModal {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0,0,0,0.85);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 9999;
    }
</style>
</head>

<body>
<div class="container">

    <!-- FULL QUESTION BOX -->
    <div class="question-box" id="questionBox">

        <!-- IMAGE ABOVE QUESTION TEXT -->
        <img id="questionImage"
             src=""
             style="max-width:100%; border-radius:12px; margin-bottom:12px; display:none; cursor:pointer;">

        <div id="questionText"></div>
    </div>

    <!-- OPTIONS -->
    <div class="options">
        <div class="option" id="btnRed"></div>
        <div class="option" id="btnOrange"></div>
        <div class="option" id="btnGreen"></div>
        <div class="option" id="btnBlue"></div>
    </div>

    <button id="nextBtn" disabled>Next Question</button>
</div>

<!-- FULLSCREEN IMAGE VIEWER -->
<div id="imageModal">
    <img id="modalImage" src="" style="max-width:95%; max-height:95%; border-radius:12px;">
</div>

<script>
    // ========================
    // GET ELEMENTS
    // ========================
    const questionBox = document.getElementById("questionBox");
    const questionText = document.getElementById("questionText");
    const questionImage = document.getElementById("questionImage");

    const imageModal = document.getElementById("imageModal");
    const modalImage = document.getElementById("modalImage");

    const btns = {
        Red: document.getElementById("btnRed"),
        Orange: document.getElementById("btnOrange"),
        Green: document.getElementById("btnGreen"),
        Blue: document.getElementById("btnBlue")
    };

    const nextBtn = document.getElementById("nextBtn");

    // ========================
    // YOUR SET (LOADED FROM LOCALSTORAGE)
    // ========================
    const set = JSON.parse(localStorage.getItem("currentStudySet"));

    let currentIndex = 0;

    // ========================
    // SHOW QUESTION
    // ========================
    function showQuestion(i) {
        const q = set.questions[i];

        // QUESTION TEXT
        questionText.textContent = q.question;

        // IMAGE ABOVE TEXT
        if (q.image && q.image.trim() !== "") {
            questionImage.src = q.image;
            questionImage.style.display = "block";
        } else {
            questionImage.style.display = "none";
        }

        nextBtn.disabled = true;

        // BUTTONS
        const colors = ["Red", "Orange", "Green", "Blue"];
        colors.forEach((color, idx) => {
            const btn = btns[color];
            btn.textContent = q.options[idx] || "";
            btn.disabled = false;
            btn.classList.remove("option-correct", "option-wrong");
            btn.onclick = () => selectAnswer(btn.textContent, q.answer);
        });
    }

    // ========================
    // ANSWER SELECTION
    // ========================
    function selectAnswer(choice, correct) {

        const normalizedChoice = choice.trim().toLowerCase();
        const normalizedCorrect = correct.trim().toLowerCase();

        const colors = ["Red","Orange","Green","Blue"];

        colors.forEach((color) => {
            const btn = btns[color];
            if (btn.textContent.trim().toLowerCase() === normalizedCorrect) {
                btn.classList.add("option-correct");
            } else if (btn.textContent.trim().toLowerCase() === normalizedChoice) {
                btn.classList.add("option-wrong");
            }
            btn.disabled = true;
        });

        nextBtn.disabled = false;
    }

    // ========================
    // NEXT QUESTION
    // ========================
    nextBtn.onclick = () => {
        currentIndex++;
        if (currentIndex >= set.questions.length) {
            alert("You finished the set!");
            return;
        }
        showQuestion(currentIndex);
    };

    // ========================
    // CLICK IMAGE TO ENLARGE
    // ========================
    questionImage.onclick = () => {
        modalImage.src = questionImage.src;
        imageModal.style.display = "flex";
    };

    imageModal.onclick = () => {
        imageModal.style.display = "none";
    };

    // START
    showQuestion(currentIndex);
</script>

</body>
</html>
