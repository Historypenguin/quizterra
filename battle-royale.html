<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quizterra | Battle Royale</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    font-family: Poppins, sans-serif;
    background: linear-gradient(135deg, #47a7ff, #745cff, #ff4ef2);
    background-size: 400% 400%;
    animation: gradientMove 11s ease infinite;
    color: white;
    text-align: center;
    padding: 30px;
  }

  @keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  h1 {
    font-size: 50px;
    font-weight: 900;
    margin-bottom: 20px;
  }

  #flag {
    width: 70px;
    margin-bottom: 20px;
  }

  #battleLog {
    margin-top: 25px;
    background: rgba(0,0,0,0.25);
    padding: 15px;
    height: 160px;
    width: 80%;
    margin-left: auto;
    margin-right: auto;
    border-radius: 15px;
    overflow-y: auto;
    text-align: left;
  }

  .hp-container {
    width: 80%;
    margin: auto;
    margin-bottom: 20px;
  }

  .hp-bar {
    width: 100%;
    height: 30px;
    background: rgba(255,255,255,0.2);
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 10px;
  }

  .hp-fill {
    height: 100%;
    background: #0fa6ff;
    width: 100px;
    text-align: center;
    line-height: 30px;
    font-weight: 700;
    transition: width 0.3s;
  }

  #questionBox {
    margin-top: 25px;
    font-size: 28px;
    font-weight: 700;
  }

  .options {
    margin-top: 20px;
    display: flex;
    justify-content: center;
    gap: 20px;
  }

  .opt-btn {
    padding: 15px 25px;
    font-size: 20px;
    font-weight: 700;
    border: none;
    cursor: pointer;
    border-radius: 12px;
    transition: 0.3s;
  }

  .option-correct {
    background: #00ff88 !important;
    color: black !important;
  }

  .option-wrong {
    background: #ff4444 !important;
    color: black !important;
  }
</style>
</head>

<body>

<h1>BATTLE ROYALE</h1>
<img id="flag" src="https://flagsapi.com/US/flat/64.png">

<div class="hp-container">
  <h3>Your HP</h3>
  <div class="hp-bar"><div id="playerHpBar" class="hp-fill">100</div></div>

  <h3 id="enemyName">Enemy</h3>
  <div class="hp-bar"><div id="enemyHpBar" class="hp-fill">50</div></div>
</div>

<div id="questionBox">Loading question...</div>

<div class="options">
  <button class="opt-btn" id="Red">Red</button>
  <button class="opt-btn" id="Orange">Orange</button>
  <button class="opt-btn" id="Green">Green</button>
  <button class="opt-btn" id="Blue">Blue</button>
</div>

<div id="battleLog"></div>

<script>
// ====== PLAYER & ENEMY SETTINGS ======

let playerHp = 100;
const maxHp = 100;

const enemyRounds = [
  { name:"Round 1", hp:50, attack:10 },
  { name:"Round 2", hp:60, attack:12 },
  { name:"Round 3", hp:70, attack:14 },
  { name:"Round 4", hp:80, attack:16 },
  { name:"Round 5", hp:100, attack:18 },
  { name:"Round 6", hp:150, attack:20 }
];

let currentRound = 0;
let enemy = null;

// ====== BUTTON REFERENCES ======

const btns = {
  "Red": document.getElementById("Red"),
  "Orange": document.getElementById("Orange"),
  "Green": document.getElementById("Green"),
  "Blue": document.getElementById("Blue")
};

// ====== LOG FUNCTION ======

function log(msg){
  let box = document.getElementById("battleLog");
  box.innerHTML += msg + "<br>";
  box.scrollTop = box.scrollHeight;
}

// ====== LOAD NEW ENEMY ======

function loadEnemy(){
  enemy = JSON.parse(JSON.stringify(enemyRounds[currentRound]));

  document.getElementById("enemyName").innerText = enemy.name;

  document.getElementById("enemyHpBar").style.width = enemy.hp + "px";
  document.getElementById("enemyHpBar").textContent = enemy.hp;

  // Reset player HP every round
  playerHp = 100;
  document.getElementById("playerHpBar").style.width = "100px";
  document.getElementById("playerHpBar").textContent = "100";

  log(`üî• New Round: ${enemy.name}`);

  showQuestion();
}

// ====== QUESTIONS ======

function randomQuestion(){
  const questions = [
    { q:"What color is the sky?", answer:"Blue" },
    { q:"What color is fire?", answer:"Red" },
    { q:"What color is grass?", answer:"Green" },
    { q:"Which is a fruit color?", answer:"Orange" }
  ];
  return questions[Math.floor(Math.random()*questions.length)];
}

// ====== SHOW QUESTION ======

function showQuestion(){
  const data = randomQuestion();
  currentCorrect = data.answer;
  document.getElementById("questionBox").innerText = data.q;

  Object.values(btns).forEach(btn=>{
    btn.disabled = false;
    btn.classList.remove("option-correct","option-wrong");
  });
}

let currentCorrect = "";

// ====== SAVE STATS ======

function saveStat(correct){
  let user = JSON.parse(localStorage.getItem("quizterraUser")) || {};
  if(!user.stats) user.stats = { correct:0, wrong:0 };

  if(correct) user.stats.correct++;
  else user.stats.wrong++;

  localStorage.setItem("quizterraUser", JSON.stringify(user));
}

// ====== BUTTON CLICK LOGIC ======

Object.keys(btns).forEach(id=>{
  btns[id].onclick = () => nextQuestion(currentCorrect, id);
});

// ====== MAIN QUESTION HANDLER ======

function nextQuestion(correct, picked){

  // lock all buttons
  Object.values(btns).forEach(b => b.disabled = true);

  // Mark correct & wrong buttons
  Object.values(btns).forEach(btn=>{
    if(btn.textContent===correct) btn.classList.add("option-correct");
    if(btn.textContent===picked && picked!==correct) btn.classList.add("option-wrong");
  });

  // Update stats (correct/wrong answers)
  saveStat(picked===correct);

  // PLAYER did damage?
  if(picked === correct){
    enemy.hp -= 20;
    log(`‚úÖ Correct! You deal 20 damage.`);
  } else {
    playerHp -= 15;
    log(`‚ùå Wrong! You lose 15 HP.`);
  }

  // ENEMY counter attack if alive
  if(enemy.hp > 0){
    playerHp -= enemy.attack;
    log(`‚öîÔ∏è Enemy hits you for ${enemy.attack}.`);
  }

  // Update bars
  if(enemy.hp < 0) enemy.hp = 0;
  document.getElementById("enemyHpBar").style.width = enemy.hp+"px";
  document.getElementById("enemyHpBar").textContent = enemy.hp;

  if(playerHp < 0) playerHp = 0;
  document.getElementById("playerHpBar").style.width = playerHp+"px";
  document.getElementById("playerHpBar").textContent = playerHp;

  // Check defeat
  if(playerHp <= 0){
    log("üíÄ You lost...");
    return;
  }

  // Check enemy defeat
  if(enemy.hp <= 0){
    log(`üèÜ ${enemy.name} defeated!`);

    currentRound++;
    if(currentRound >= enemyRounds.length){
      log("üéâ YOU WIN THE BATTLE ROYALE!");
      return;
    }

    setTimeout(loadEnemy, 1500);
    return;
  }

  setTimeout(showQuestion, 1000);
}

// ====== START GAME ======

loadEnemy();

</script>
</body>
</html>
