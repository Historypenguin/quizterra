<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quizterra | Inventory</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
    body {
        font-family: Poppins, sans-serif;
        background: #f0f2f5;
        margin: 0;
        padding: 0;
    }
    header {
        padding: 20px;
        background: #6a11cb;
        background: linear-gradient(135deg, #6a11cb, #2575fc);
        color: white;
        text-align: center;
    }
    #tokens {
        font-weight: 700;
    }
    .inventory-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        padding: 20px;
        gap: 15px;
    }
    .card {
        background: white;
        padding: 15px;
        border-radius: 12px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        width: 180px;
        text-align: center;
        position: relative;
    }
    .card h3 {
        margin: 10px 0 5px 0;
    }
    .rarity {
        font-weight: 600;
        margin-bottom: 5px;
    }
    .amount {
        font-size: 0.9rem;
        color: #555;
        margin-bottom: 10px;
    }
    button {
        margin: 5px 2px;
        padding: 5px 10px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
    }
    .sell-btn { background: #ff4d4f; color: white; }
    .profile-btn { background: #52c41a; color: white; }
</style>
</head>
<body>
<header>
    <h1>Quizterra Inventory</h1>
    <p>Tokens: <span id="tokens">0</span></p>
</header>

<div class="inventory-container" id="inventory"></div>

<script>
let quizterraStorage = JSON.parse(localStorage.getItem('quizterraStorage')) || {};
let currentUser = localStorage.getItem('quizterraCurrentUser') || null;

if (!currentUser || !quizterraStorage[currentUser]) {
    alert('No user logged in! Redirecting to login page.');
    window.location.href = 'login.html';
}

let userData = quizterraStorage[currentUser];
document.getElementById('tokens').textContent = userData.tokens || 0;

function renderInventory() {
    const container = document.getElementById('inventory');
    container.innerHTML = '';

    userData.inventory.forEach((item, index) => {
        const card = document.createElement('div');
        card.classList.add('card');

        card.innerHTML = `
            <h3>${item.name}</h3>
            <div class="rarity">${item.rarity}</div>
            <div class="amount">Amount: ${item.amount || 1}</div>
            <button class="sell-btn">Sell</button>
            <button class="profile-btn">Set Profile</button>
        `;

        // Sell button
        card.querySelector('.sell-btn').addEventListener('click', () => {
            let amountToSell = parseInt(prompt(`How many ${item.name} to sell? (1-${item.amount})`, '1'));
            if (!amountToSell || amountToSell < 1) amountToSell = 1;
            if (amountToSell > item.amount) amountToSell = item.amount;

            let sellPrice = 0;
            switch(item.rarity.toLowerCase()) {
                case 'uncommon': sellPrice = 5 * amountToSell; break;
                case 'rare': sellPrice = 20 * amountToSell; break;
                case 'epic': sellPrice = 75 * amountToSell; break;
                case 'legendary': sellPrice = 200 * amountToSell; break;
                case 'chroma': sellPrice = 300 * amountToSell; break;
                case 'unique': sellPrice = 400 * amountToSell; break;
                case 'mystical': sellPrice = 1000 * amountToSell; break;
                case 'heavenly': sellPrice = 2000 * amountToSell; break;
            }

            userData.tokens += sellPrice;
            item.amount -= amountToSell;

            if (item.amount <= 0) userData.inventory.splice(index, 1);

            quizterraStorage[currentUser] = userData;
            localStorage.setItem('quizterraStorage', JSON.stringify(quizterraStorage));
            alert(`Sold ${amountToSell} ${item.name}(s) for ${sellPrice} tokens!`);
            renderInventory();
            document.getElementById('tokens').textContent = userData.tokens;
        });

        // Set profile button
        card.querySelector('.profile-btn').addEventListener('click', () => {
            userData.profileCard = item.name;
            quizterraStorage[currentUser] = userData;
            localStorage.setItem('quizterraStorage', JSON.stringify(quizterraStorage));
            alert(`${item.name} is now your profile card!`);
        });

        container.appendChild(card);
    });
}

renderInventory();
</script>
</body>
</html>
